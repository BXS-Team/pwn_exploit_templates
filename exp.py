from pwnIO import *
sys.path.append("/home/pwnht/pwn_exploit_templates")
# io=pwnIO('/bin/bash','2.23')
# add=io.add_func('test',1)
# add(1,2,3)
# add.set_condition('sleep',{1:10})
# add.add_conditions('gdb.attach')
# add.set_condition('gdb.attach',{2:[io.io,"b $rebase(0x1234)"]})
# add(1,2,3)
# io.it()
context.terminal=["konsole","-e"]
flag_dir={}
ip=["127.0.0.1"]
port=[10021]
libc_base=0
libc=ELF('/usr/lib/libc.so.6')
def leak_area(address):
    libc_base=(address-libc.sym['__malloc_hook']-0x10)&0x1000
def exploit(ip,port):
    io=pwnIO('twochunk','2.27',ip[0],port[0],is_remote=False)
    add=io.add_func('add',1)
    rm=io.add_func('rm',2)
    wr=io.add_func('wr',3)
    sw=io.add_func('sw',4)
    io.it()
#    io.it()
#     io.sl("cat /flag")
#     flag=io.r()
#     return flag_dir.update({ip:{port:flag}})
# for i in port:
#     for j in ip:
#         exploit(j,i)
# for ip,value in flag_dir:
#     for port,flag in value:
#         print("ip="+ip+"   port="+str(port)+"   flag="+flag)
exploit(ip,port)
